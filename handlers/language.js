// ==================================================
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –≤—ã–±–æ—Ä–æ–º —è–∑—ã–∫–∞.
// –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —è–∑—ã–∫.
// –ü—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –≤—ã–±–æ—Ä–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —è–∑—ã–∫, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
// –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –æ–±–ª–∞—Å—Ç–µ–π.
// ==================================================

const { getLanguageKeyboard, getRegionsKeyboard } = require('../utils/keyboards');
const TEXTS = require('../constants/texts');

// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
// –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞, Map —è–∑—ã–∫–æ–≤ –∏ Map —Å–æ—Å—Ç–æ—è–Ω–∏–π.
async function handleLanguageSelection(msg, bot, userLanguages, userStates) {
    const chatId = msg.chat.id;
    const text = msg.text;

    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –æ–¥–Ω—É –∏–∑ —è–∑—ã–∫–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
    if (text === 'üá∑üá∫ –†—É—Å—Å–∫–∏–π' || text === 'üáßüáæ –ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π') {
        const lang = text === 'üá∑üá∫ –†—É—Å—Å–∫–∏–π' ? 'rus' : 'bel';
        userLanguages.set(chatId, lang); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        await bot.sendMessage(chatId, TEXTS[lang].welcome, {
            parse_mode: 'Markdown',
            disable_web_page_preview: true // –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Å—ã–ª–æ–∫ –≤ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–∏
        });
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –æ–±–ª–∞—Å—Ç—è–º–∏
        const keyboard = getRegionsKeyboard(chatId, lang, bot, userStates);
        await bot.sendMessage(chatId, TEXTS[lang].selectRegion, keyboard);
    } else {
        // –ï—Å–ª–∏ –ø—Ä–∏—Å–ª–∞–ª–∏ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç), –ø–æ–≤—Ç–æ—Ä—è–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞—Ç—å —è–∑—ã–∫
        await bot.sendMessage(chatId, 'üåê *–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / –ê–±—è—Ä—ã—Ü–µ –º–æ–≤—É:*', {
            parse_mode: 'Markdown',
            ...getLanguageKeyboard()
        });
    }
}

module.exports = handleLanguageSelection;